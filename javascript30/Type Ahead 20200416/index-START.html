<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>Type Ahead ğŸ‘€</title>
    <link rel="stylesheet" href="style.css">
</head>

<body>

    <form class="search-form">
        <input type="text" class="search" placeholder="è¯—å¥ è¯—å è¯—äºº">
        <ul class="suggestions">
            <li><span>è¯·è¾“å…¥å…³é”®å­—</span></li>
            <li><span>è¯—å¥ è¯—å è¯—äºº</span></li>
        </ul>
    </form>
    <script>
        //çŸ¥è¯†ç‚¹ : promiseå¯¹è±¡çš„ç”¨æ³•ï¼Œfetch()å¤„ç†å¼‚æ­¥ä¿¡æ¯çš„ç”¨æ³•
        const endpoint = 'https://gist.githubusercontent.com/soyaine/81399bb2b24ca1bb5313e1985533c640/raw/bdf7df2cbcf70706c4a5e51a7dfb8c933ed78878/TangPoetry.json';
        /** @type {HTMLInputElement} */
        let inputNode = document.querySelector(".search")
        let ulNode = document.querySelector("ul")
        let initText = ulNode.innerHTML
        inputNode.oninput = function() {
            fetch(endpoint)
                .then(resp => resp.json())
                .then(json => {
                        //è·å–åˆ°jsonæ•°ç»„ä¸­æ‰€æœ‰å¤è¯—å¯¹è±¡çš„æ ‡é¢˜ï¼Œæ–‡ç« ï¼Œä½œè€…ï¼Œå°è£…æˆæ–°çš„æ•°ç»„
                        let newJson = json.map(item => {
                                let newItemStr = "<span>" + item.detail_text + "</span><span>" + item.title + "  â€”" + item.detail_author[0] + "</span>"
                                return newItemStr
                            })
                            //è¿‡æ»¤æ•°å­—ï¼Œå­—æ¯ï¼Œä¸‹åˆ’çº¿ï¼Œç©ºæ ¼
                        let reg = /\w|\s/g
                            //è·å–ç”¨æˆ·è¾“å…¥çš„å­—
                        let newValue = this.value.replace(reg, "")
                            //ç”¨ç”¨æˆ·è¾“å…¥çš„å­—å»æ•°ç»„é‡Œé¢è¿‡æ»¤å‡ºæ–°æ•°ç»„
                        let newJson2 = newJson.filter(item => item.includes(newValue))
                            //æ¯æ¬¡äº‹ä»¶ç›‘å¬ä¹‹åéƒ½è¦é‡ç½®ç½‘é¡µä¸­å¤è¯—æ–‡ä¿¡æ¯
                        ulNode.innerHTML = initText
                            //å¾ªç¯éå†è¿‡æ»¤å‡ºçš„æ–°æ•°ç»„ï¼Œè£…è¿›ulé‡Œ
                        newJson2.forEach(item => {
                            let liNode = document.createElement("li")
                            liNode.innerHTML = item
                            ulNode.appendChild(liNode)
                        })
                    }


                )
        }
    </script>
</body>

</html>